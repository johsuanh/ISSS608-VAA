{
  "hash": "1afda78c5550213e5f9ca7c2aa28955b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on_Ex02: Beyond ggplot2 Fundamentals\"\ndate: 2024-01-18\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n## 2.1 Learning Object\n\nLearn several ggplot2 extentions:\n\n1.  Use **ggrepel** to control the placement of annotations on graphs\n\n2.  Use **ggthemes** and **hrbrthemes** to create professional publication quality figure\n\n3.  Use **patchwork** package to plot composite figure by combining ggplot2 graphs\n\n## 2.2 Getting Started\n\n### 2.2.1 Installing and loading the required libraries\n\n-   ggrepel: an R package provides geoms for ggplot2 to repel overlapping text labels.\n\n-   ggthemes: an R package provides some extra themes, geoms, and scales for ‘ggplot2’.\n\n-   hrbrthemes: an R package provides typography-centric themes and theme components for ggplot2.\n\n-   patchwork: an R package for preparing composite figure created using ggplot2.\n\nCode chunk below will be used to check if these packages have been installed and also will load them onto your working R environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork,ggthemes, hrbrthemes,tidyverse) \n```\n:::\n\n\n\n### 2.2.2 Importing data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"data/Exam_data.csv\")\n```\n:::\n\n\n\nThe dataset contains examination grades for 3 subjects from a local school. We can use head() and summary() function inspect the dataset.\n\nThere are a total of 7 attributes. 4 of them are categorical data type and the other 3 are in continuous data type.\n\n-   The categorical attributes are: ID, CLASS, GENDER and RACE.\n\n-   The continuous attributes are: MATHS, ENGLISH and SCIENCE.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(exam_data,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 7\n  ID         CLASS GENDER RACE    ENGLISH MATHS SCIENCE\n  <chr>      <chr> <chr>  <chr>     <dbl> <dbl>   <dbl>\n1 Student321 3I    Male   Malay        21     9      15\n2 Student305 3I    Female Malay        24    22      16\n3 Student289 3H    Male   Chinese      26    16      16\n4 Student227 3F    Male   Chinese      27    77      31\n5 Student318 3I    Male   Malay        27    11      25\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(exam_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      ID               CLASS              GENDER              RACE          \n Length:322         Length:322         Length:322         Length:322        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    ENGLISH          MATHS          SCIENCE     \n Min.   :21.00   Min.   : 9.00   Min.   :15.00  \n 1st Qu.:59.00   1st Qu.:58.00   1st Qu.:49.25  \n Median :70.00   Median :74.00   Median :65.00  \n Mean   :67.18   Mean   :69.33   Mean   :61.16  \n 3rd Qu.:78.00   3rd Qu.:85.00   3rd Qu.:74.75  \n Max.   :96.00   Max.   :99.00   Max.   :96.00  \n```\n\n\n:::\n:::\n\n\n\n## 2.3 Beyond ggplot2 Annotation: ggrepel\n\nOne of the challenges in plotting statistical graph is annotation, especially with large number of data points. As shown in the plots below, both labels and texts annotation are messy and overlapping, which makes them difficult for readers to understand.\n\n::: panel-tabset\n## geom_label()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS,y=ENGLISH))+\n  geom_point()+\n  geom_smooth(method=lm,size=0.5)+\n  geom_label(aes(label = ID),hjust=0.5,vjust=-0.5)+\n  coord_cartesian(xlim=c(0,100), ylim = c(0,100))+\n  ggtitle(\"English scores versus Maths scores for Primary 3\")+\n  theme_classic()+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color behind the bar chart\n        panel.background = element_rect(fill = \"#f3f1e9\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## geom_text()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS,y=ENGLISH))+\n  geom_point()+\n  geom_smooth(method=lm,size=0.5)+\n  geom_text(aes(label = ID),hjust=0.5,vjust=-0.5)+\n  coord_cartesian(xlim=c(0,100), ylim = c(0,100))+\n  ggtitle(\"English scores versus Maths scores for Primary 3\")+\n  theme_classic()+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color behind the bar chart\n        panel.background = element_rect(fill = \"#f3f1e9\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n:::\n\n##### \n\nThis is where [**ggrepel**](https://ggrepel.slowkow.com/) comes in. It is an extension of **ggplot2** package, provides `geoms` for **ggplot2** to repel overlapping text as in our examples above.\n\nWe simply replace `geom_text()` by [`geom_text_repel()`](https://ggrepel.slowkow.com/reference/geom_text_repel.html) and `geom_label()` by [`geom_label_repel`](https://ggrepel.slowkow.com/reference/geom_text_repel.html).\n\nHowever, since ggrepel's purpose is to prevent overlapping labels and texts, it will only display non-overlapping labels when there are too many to fit in the plot. To show more labels, we can adjust the parameter `max.overlaps = 20` , the higher this number, the more labels will be displayed.\n\n::: panel-tabset\n## geom_label_repel()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS,y=ENGLISH))+\n  # Use aes(color=cat) to seperate points by diff colors\n  geom_point(aes(color=GENDER))+\n  scale_color_manual(values = c(\"#D9A4C3\", \"#A4A8D9\"))+\n  geom_smooth(method=lm,size=0.5)+\n  # Use aes(color=cat) to seperate labels by diff colors\n  geom_label_repel(aes(label = ID, color = GENDER),\n                   size = 3,\n                   fontface=\"bold\",\n                   # change this setting to get more labels\n                   max.overlaps = 20)+\n  coord_cartesian(xlim=c(0,100), ylim = c(0,100))+\n  ggtitle(\"English scores versus Maths scores for Primary 3 by Gender\")+\n  theme_classic()+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color behind the bar chart\n        panel.background = element_rect(fill = \"#f3f1e9\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## geom_text_repel()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data,\n       aes(x=MATHS,y=ENGLISH))+\n  geom_point(aes(color=GENDER))+\n  scale_color_manual(values = c(\"#D9A4C3\", \"#A4A8D9\"))+\n  geom_smooth(method=lm,size=0.5)+\n  geom_text_repel(aes(label = ID,color = GENDER))+\n  coord_cartesian(xlim=c(0,100), ylim = c(0,100))+\n  ggtitle(\"English scores versus Maths scores for Primary 3 by Gender\")+\n  theme_classic()+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color behind the bar chart\n        panel.background = element_rect(fill = \"#f3f1e9\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n:::\n\n## 2.4 Beyond ggplot2 Themes\n\nggplot2 comes with eight [built-in themes](https://ggplot2.tidyverse.org/reference/ggtheme.html), they are: `theme_gray()`, `theme_bw()`, `theme_classic()`, `theme_dark()`, `theme_light()`, `theme_linedraw()`, `theme_minimal()`, and `theme_void()`:\n\n::: panel-tabset\n## theme_classic()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_classic()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## theme_minimal()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_minimal()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## theme_bw()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_bw()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        # adjust the color of panel grid\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## theme_dark()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_dark()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## theme_light()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_light()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## theme_linedraw()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_linedraw()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## theme_void()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = RACE))+\n  geom_bar(bins=20,fill=\"#E8C8DB\",color=\"black\")+\n  coord_flip()+\n  theme_void()+\n  ggtitle(\"Number of Students by Race\")+\n  theme(plot.title = element_text(hjust = 0.5, face=\"bold\"),\n        # adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA),\n        legend.background = element_rect(fill = \"#f3f1e9\"))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### 2.4.1 Working with ggtheme package\n\n[**ggthemes**](https://cran.r-project.org/web/packages/ggthemes/) provides [‘ggplot2’ themes](https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/) that replicate the look of plots by Edward Tufte, Stephen Few, [Fivethirtyeight](https://fivethirtyeight.com/), [The Economist](https://www.economist.com/graphic-detail), ‘Stata’, ‘Excel’, and [The Wall Street Journal](https://www.pinterest.com/wsjgraphics/wsj-graphics/), among others.\n\n::: panel-tabset\n## theme_wsj()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS, y= ENGLISH))+\n  geom_point(aes(color = RACE))+\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_wsj(base_size = 10) + scale_color_wsj()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n## theme_economist()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS))+\n  geom_histogram(bins=20, boundary=100,color=\"grey25\",fill=\"grey90\")+\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n## theme_fivethirtyeight()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS))+\n  geom_histogram(bins=20, boundary=100,color=\"grey25\",fill=\"grey90\")+\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_fivethirtyeight()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### 2.4.2 Working with hrbthemes package\n\n[**hrbrthemes**](https://hrbrmstr.github.io/hrbrthemes/) package provides a base theme that focuses on typographic elements (default font type is Arial), including where various labels are placed as well as the fonts that are used.\n\n::: {.callout-note appearance=\"simple\"}\n-   `axis_title_size` argument is used to increase the font size of the axis title to 18,\n\n-   `base_size` argument is used to increase the default axis label to 15, and\n\n-   `grid` argument is used to remove the x-axis and y-axis grid lines. The default setting is grid = \"XY\", if user only want to remain horizontal grid lines, set grid = \"Y\"\n\n-   `axis` argument control whether to show or hide the x-axis and y-axis lines. By default, the axes are hidden.\n:::\n\n::: {.callout-note appearance=\"simple\"}\nTo make the graph more informative and descriptive, we can use `lab()` function to add the subtitle and the source:\n\n**labs( title=\" \", subtitle=\" \", caption=\" \", x=\" \", y=\" \")**\n\n-   add \"\\\\n\" to create line breaks when your subtitle is too long to be displayed on a single line.\n:::\n\nBelow are the plots using hrbthemes:\n\n::: panel-tabset\n## Default\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(x = MATHS)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"grey90\") +\n  labs(title=\"Distribution of Maths scores\",\n    subtitle=\"The Math Score distribution for Primary 3 is left-skewed,\\n indicating that most students achieved high grades in math\",\n    x=\"Math Score\",\n    caption=\"Source: ISSS608 VAA\")+\n  theme_ipsum()+\n  theme(# adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## Customized\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"grey90\") +\n  labs(title=\"Distribution of Maths scores\",\n    subtitle=\"The Math Score distribution for Primary 3 is left-skewed,\\n indicating that most students achieved high grades in math\",\n    x=\"Math Score\",\n    caption=\"Source: ISSS608 VAA\")+\n  theme_ipsum(grid = \"Y\",  axis_title_size = 10 , base_size = 12)+\n  theme(# adjust the background color of the whole plot\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n:::\n\n## 2.5 Beyond Single Graph\n\nThere are several ggplot2 extensions provide functions to compose figure with multiple graphs, such as [`grid.arrange()`](https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html) of **gridExtra** package,  [`plot_grid()`](https://wilkelab.org/cowplot/reference/plot_grid.html) of [**cowplot**](https://wilkelab.org/cowplot/) package, and ggplot2 extension called [**patchwork**](https://patchwork.data-imaginist.com/) which is specially designed for combining separate ggplot2 graphs into a single figure.\n\nPatchwork package has a very simple syntax where we can create layouts super easily. Here’s the general syntax that combines:\n\n-   Two-Column Layout using the Plus Sign +.\n\n-   Parenthesis () to create a subplot group.\n\n-   Two-Row Layout using the Division Sign `/`\n\n### 2.5.1 Combining two ggplot2 graphs\n\nFirst, let's draw several graphs:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"#E8C8DB\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")+\n  theme_classic()+\n  theme(plot.title = element_text(size = 12, face=\"bold\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"#C8CBE8\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")+\n  theme_classic()+\n  theme(plot.title = element_text(size = 12, face=\"bold\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n\n\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, size=0.5) +  \n  coord_cartesian(xlim=c(0,100), ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores\")+\n  theme_classic()+\n  theme(plot.title = element_text(size = 12, face=\"bold\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1+p2\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n### 2.5.2 Combining three or more ggplot2 graphs\n\nWe can plot more complex composite by using appropriate operators. For example, the composite figure below is plotted by using:\n\n-   “/” operator to stack two ggplot2 graphs,\n\n-   “\\|” operator to place the plots beside each other,\n\n-   “()” operator the define the sequence of the plotting.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n### 2.5.3 Creating a composite figure with tag\n\nIn order to identify subplots in text, **patchwork** also provides auto-tagging capabilities as shown in the figure below.\n\ntag_levels could be 'I', 'A', '1', c('A','1') \\<- meaning combine A&1\n\n::: panel-tabset\n## I\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1/p2)|p3) + \n  plot_annotation(tag_levels = 'I')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n## A\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1+p2)/p3) + \n  plot_annotation(tag_levels = 'A')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n## 1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1/p2)|p3) + \n  plot_annotation(tag_levels = '1')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### 2.5.4 Adding subtitle and caption to the patchwork\n\nwe can also use [plot_annotation()](https://patchwork.data-imaginist.com/reference/plot_annotation.html) to add the title, subtitle and caption to the patchwork, and use theme() argument to cusomize the font size, font weight, background color and other visual parameters.\n\n::: {.callout-warning appearance=\"simple\"}\nHere we add theme() parameter in plot_annotation() to adjsut the element of patchwork's title , subtitle...instead of using \"&\" or \"+\" to link functions.\n\nHowever, we can use \"& theme()\" after plot_annotation() to adjust the visual parameters of the graphs in the patchwork together.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1 / p2) | p3) +\n  plot_annotation(\n    tag_levels = \"I\",\n    title = \"Exam Performance for Primary 3\",\n    subtitle = \"The plots show that there is a positive relationship between Math scores and English scores.\\nIn addtion, most students of Primary 3 got high scores on both subjects.\",\n    caption = \"Source: ISSS608 VAA\",\n    theme = theme(plot.title = element_text(size = 14, face = \"bold\"),\n    plot.background = element_rect(fill = \"#f3f1e9\", color = NA),\n    plot.margin = margin(10, 10, 10, 10))) &\n    theme(axis.title = element_text(size=8) # adjust all axis titles to size = 8\n          )\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n### 2.5.5 Creating figure with insert\n\nBeside providing functions to place plots next to each other based on the provided layout. With [`inset_element()`](https://patchwork.data-imaginist.com/reference/inset_element.html) of **patchwork**, we can place one or several plots or graphic elements freely on top or below another plot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, left=0.02, bottom =0.6, right=0.5, top=1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n### 2.5.6 Creating a composite figure by using patchwork and ggtheme\n\nFigure below is created by combining patchwork and theme_economist() of ggthemes package discussed earlier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np4 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n\n\n\np5 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, boundary = 100,\n                 color=\"grey25\", fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n\n\np6 <- ggplot(data=exam_data, \n             aes(x= MATHS, y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, size=0.5) +  \n  coord_cartesian(xlim=c(0,100), ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores\")\n\n\n\n((p4 / p5) | p6) + \n    plot_annotation(\n    title = \"Exam Performance for Primary 3\",\n    subtitle = \"The plots show that there is a positive relationship between Math scores and English scores.\\nIn addtion, most students of Primary 3 got high scores on both subjects.\",\n    caption = \"Source: ISSS608 VAA\")& \n                    theme_economist() &\n                    theme(axis.title.x = element_text(size=8, margin = margin(t=5)), #above\n                          axis.title.y = element_text(size=8, margin = margin(r=5)),\n                          axis.text.x = element_text(size = 8),  \n                          axis.text.y = element_text(size = 6),\n                          plot.title = element_text(size = 11))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n## 2.6 Reference\n\n-   [R for Visual Analytics-Beyond ggplot2 Fundamentals](https://r4va.netlify.app/chap02)\n\n-   [Patchwork R package goes nerd viral](https://www.littlemissdata.com/blog/patchwork)\n\n-   [ggrepel](https://ggrepel.slowkow.com/)\n\n-   [ggthemes](https://ggplot2.tidyverse.org/reference/ggtheme.html)\n\n-   [hrbrthemes](https://cinc.rud.is/web/packages/hrbrthemes/)\n\n-   [ggplot tips: Arranging plots](https://albert-rapp.de/post/2021-10-28-extend-plot-variety/)\n\n-   [ggplot2 Theme Elements Demonstration](https://henrywang.nl/ggplot2-theme-elements-demonstration/)\n\n-   [ggplot2 Theme Elements Reference Sheet](https://isabella-b.com/blog/ggplot2-theme-elements-reference/)\n",
    "supporting": [
      "Hands-on_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}