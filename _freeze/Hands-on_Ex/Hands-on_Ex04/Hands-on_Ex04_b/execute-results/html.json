{
  "hash": "2124cb8dd8db4420ff62cf5122fd72dc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 04.b\"\nauthor: Johsuan Huang\ndate: 2024-02-03\ndate-modified: \"last-modified\"\ndescription: \"Visual Statistical Analysis\"\ncategories: [ggplot2,ggstatsplot, nortest, performance, parameters, see]\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n## 1 Learning Outcome\n\nIn this exercise, we will gain hands-on expirience on using:\n\n-   **ggstatsplot** package to create visual graphics with rich statistical information\n\n-   **performance** package to visualise model diagnostics\n\n-   **parameters** package to visualise model parameters\n\n## 2 Getting Started\n\n::: panel-tabset\n## Loading the packages\n\nUse the **pacman** package `p_load()` to check, install and launch the following R packages:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggstatsplot, tidyverse, nortest)\n```\n:::\n\n\n\n+-------------+----------------------------------------------------------------------------------------------------------------------------------+\n| **Library** | **Description**                                                                                                                  |\n+=============+==================================================================================================================================+\n| ggstatsplot | a ggplot2 extension for creating graphics with details from statistical tests included in the information-rich plots themselves. |\n+-------------+----------------------------------------------------------------------------------------------------------------------------------+\n| tidyverse   | a family of R packages for data processing                                                                                       |\n+-------------+----------------------------------------------------------------------------------------------------------------------------------+\n| nortest     | a package for normality test                                                                                                     |\n+-------------+----------------------------------------------------------------------------------------------------------------------------------+\n\n## Importing the data\n\nIn this exercise, ***Exam_data.csv*** will be used. We use `read_csv()` of **readr** to import the data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam <- read_csv(\"data/Exam_data.csv\")\n```\n:::\n\n\n\n## Examining the data\n\nAfter importing the data, let's examine it to understand its data structure:\n\nThe dataset contains 7 attributes and 322 observations with no missing values.\n\n-   The categorical attributes are: ID, CLASS, GENDER and RACE.\n\n-   The continuous attributes are: MATHS, ENGLISH and SCIENCE.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(exam)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  ID         CLASS GENDER RACE    ENGLISH MATHS SCIENCE\n  <chr>      <chr> <chr>  <chr>     <dbl> <dbl>   <dbl>\n1 Student321 3I    Male   Malay        21     9      15\n2 Student305 3I    Female Malay        24    22      16\n3 Student289 3H    Male   Chinese      26    16      16\n4 Student227 3F    Male   Chinese      27    77      31\n5 Student318 3I    Male   Malay        27    11      25\n6 Student306 3I    Female Malay        31    16      16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(exam)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nspc_tbl_ [322 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ ID     : chr [1:322] \"Student321\" \"Student305\" \"Student289\" \"Student227\" ...\n $ CLASS  : chr [1:322] \"3I\" \"3I\" \"3H\" \"3F\" ...\n $ GENDER : chr [1:322] \"Male\" \"Female\" \"Male\" \"Male\" ...\n $ RACE   : chr [1:322] \"Malay\" \"Malay\" \"Chinese\" \"Chinese\" ...\n $ ENGLISH: num [1:322] 21 24 26 27 27 31 31 31 33 34 ...\n $ MATHS  : num [1:322] 9 22 16 77 11 16 21 18 19 49 ...\n $ SCIENCE: num [1:322] 15 16 16 31 25 16 25 27 15 37 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   ID = col_character(),\n  ..   CLASS = col_character(),\n  ..   GENDER = col_character(),\n  ..   RACE = col_character(),\n  ..   ENGLISH = col_double(),\n  ..   MATHS = col_double(),\n  ..   SCIENCE = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(exam)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      ID               CLASS              GENDER              RACE          \n Length:322         Length:322         Length:322         Length:322        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    ENGLISH          MATHS          SCIENCE     \n Min.   :21.00   Min.   : 9.00   Min.   :15.00  \n 1st Qu.:59.00   1st Qu.:58.00   1st Qu.:49.25  \n Median :70.00   Median :74.00   Median :65.00  \n Mean   :67.18   Mean   :69.33   Mean   :61.16  \n 3rd Qu.:78.00   3rd Qu.:85.00   3rd Qu.:74.75  \n Max.   :96.00   Max.   :99.00   Max.   :96.00  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(exam))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n\n## Transforming the data\n\nIn R, factors are used to handle categorical data and ordered variable. As there are categorical attributes in our dataset, we are going to convert their data type from \\<chr\\> to \\<fctr\\>:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncol <- c(\"CLASS\",\"GENDER\",\"RACE\")\nexam <- exam %>% mutate(across(all_of(col), as.factor))\n```\n:::\n\n\n\nAfter converting the attributes, let's check the data again:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(exam)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  ID         CLASS GENDER RACE    ENGLISH MATHS SCIENCE\n  <chr>      <fct> <fct>  <fct>     <dbl> <dbl>   <dbl>\n1 Student321 3I    Male   Malay        21     9      15\n2 Student305 3I    Female Malay        24    22      16\n3 Student289 3H    Male   Chinese      26    16      16\n4 Student227 3F    Male   Chinese      27    77      31\n5 Student318 3I    Male   Malay        27    11      25\n6 Student306 3I    Female Malay        31    16      16\n```\n\n\n:::\n:::\n\n\n:::\n\n## 3 Statistics Test: ggstatsplot\n\n### 3.1 One-sample test: *gghistostats()* method\n\nIn the code chunk below, [*gghistostats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/gghistostats.html) of **ggstatsplot** is used to to build an visual of one-sample test on English scores.\n\n-   One-sample test is a statistical test used to determine whether the mean of a single sample is significantly different from a known or hypothesized population mean (mu=60).\n\n:::: panel-tabset\n## BF-plot\n\n#### Hypothesis\n\nH0: Mean of English score = 60\n\nH1: Mean of English score != 60\n\n#### Conclusion\n\nSince BF = e\\^-31.52, which is a tiny number close to 0. We have significant evidence to reject the null hypothesis and conclude that the mean English score doesn't equal to 60.\n\n::: toggle\n<details>\n\n<summary>**Display Code**</summary>\n\n``` r\nset.seed(1)\n\ngghistostats(exam,\n             x = ENGLISH,\n             type = \"bayes\",\n             test.value = 60, #mu\n             xlab = \"English scores\",\n             bin.args = list(fill = \"grey90\", color=\"grey30\"),\n             centrality.line.args = list(color = \"black\", linewidth = 1, linetype = \"dashed\"))+\n  theme(panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n</details>\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## Argument\n\ngghistostats() includes below arguments:\n\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Argument                 | Description                                                                                                                                                                                                        |\n+==========================+====================================================================================================================================================================================================================+\n| **binwidth**             | The width of the histogram bins. The default is to use the `max(x) - min(x) / sqrt(N)`                                                                                                                             |\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **type**                 | A character specifying the type of statistical approach and its hypothesis testing:                                                                                                                                |\n|                          |                                                                                                                                                                                                                    |\n|                          | -   `\"parametric\"`: One-sample Student's *t*-test ([stats::t.test()](https://rdrr.io/r/stats/t.test.html))                                                                                                         |\n|                          |                                                                                                                                                                                                                    |\n|                          | -   `\"nonparametric\"`: One-sample Wilcoxon test ([stats::wilcox.test()](https://rdrr.io/r/stats/wilcox.test.html))                                                                                                 |\n|                          |                                                                                                                                                                                                                    |\n|                          | -   `\"robust\"`: Bootstrap-*t* method for one-sample test([WRS2::trimcibt()](https://rdrr.io/pkg/WRS2/man/trimcibt.html))                                                                                           |\n|                          |                                                                                                                                                                                                                    |\n|                          | -   `\"bayes\"`: One-sample Student's *t*-test ([BayesFactor::ttestBF()](https://rdrr.io/pkg/BayesFactor/man/ttestBF.html))                                                                                          |\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **test.value**           | A number indicating the true value of the mean (Default: `0`).                                                                                                                                                     |\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **bin.args**             | A list of additional aesthetic arguments to be passed to the `stat_bin` used to display the bins.                                                                                                                  |\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **centrality.line.args** | A list of additional aesthetic arguments to be passed to the [`ggplot2::geom_line()`](https://ggplot2.tidyverse.org/reference/geom_path.html) used to display the lines corresponding to the centrality parameter. |\n+--------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n::::\n\n#### 3.1.1 Bayes Factor\n\n-   A Bayes factor is the ratio of the likelihood of one particular hypothesis to the likelihood of another. It can be interpreted as a measure of the strength of evidence in favor of one theory among two competing theories.\n\n-   That’s because the Bayes factor gives us a way to evaluate the data in favor of a null hypothesis, and to use external information to do so. It tells us what the weight of the evidence is in favor of a given hypothesis.\n\n-   When we are comparing two hypotheses, H1 (the alternate hypothesis) and H0 (the null hypothesis), the Bayes Factor is often written as B10. It can be defined mathematically as\n\n-   The [**Schwarz criterion**](https://www.statisticshowto.com/bayesian-information-criterion/) is one of the easiest ways to calculate rough approximation of the Bayes Factor.\n\n-   Bayes Factor can be any **positive number**:\n\n    One of the most common interpretations is this one—first proposed by Harold Jeffereys (1961) and slightly modified by [Lee and Wagenmakers](https://www-tandfonline-com.libproxy.smu.edu.sg/doi/pdf/10.1080/00031305.1999.10474443?needAccess=true) in 2013:\n\n    ![](/images/bayes_factor.png)\n\n#### \n\nHowever, before one-sample testing, we should use Anderson-Darling normality test to check if English scores follow normal distribution:\n\n**Hypothesis**\n\nH0: English scores follow the normal distribution\n\nH1: English scores don't follow the normal distribution\n\nalpha = 0.05\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nad.test(exam$ENGLISH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAnderson-Darling normality test\n\ndata:  exam$ENGLISH\nA = 4.3661, p-value = 7.341e-11\n```\n\n\n:::\n:::\n\n\n\nResults from the Anderson-Darling normality test shows siginificant evidence (p-value \\<0.05) to reject the null hypothesis and conclude that the English scores do not follow normal distribution . Thus **non parametric: One-sample Wilcoxon test** is used in the following one-sample test model.\n\n**Hypothesis**:\n\nH0: Mean of English score = 60\n\nH1: Mean of English score != 60\n\nAlpha = 0.05\n\n::: {.callout-tip appearance=\"simple\"}\n## Conclusion\n\nWe reach the same conclusion using both approaches:\n\nSince the p-value \\< 0.05, we have significant evidence to reject the null hypothesis and suggests that the mean English score is different from 60.\n:::\n\n::: toggle\n<details>\n\n<summary>**Display Code**</summary>\n\n``` r\nset.seed(1)\n\ngghistostats(exam,\n             x = ENGLISH,\n             type = \"np\",\n             test.value = 60, #mu\n             xlab = \"English scores\",\n             bin.args = list(fill = \"grey90\", color=\"grey30\"),\n             centrality.line.args = list(color = \"black\", linewidth = 1, linetype = \"dashed\"))+\n  theme(panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n</details>\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n### 3.2 Two-sample mean test: ***ggbetweenstats()*** **method**\n\n[*ggbetweenstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html) is used to build a visual for two-sample mean test of Maths scores by gender:\n\nBefore testing, we use Shapiro-Wilk normality test to check if math scores for both genders follow normal distribution:\n\n**Hypothesis**\n\nH0: Math scores for male / female follow the normal distribution\n\nH1: Math scores for male / female don't follow the normal distribution\n\nalpha = 0.05\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nby(exam$ENGLISH, exam$GENDER, shapiro.test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nexam$GENDER: Female\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.95337, p-value = 2.026e-05\n\n------------------------------------------------------------ \nexam$GENDER: Male\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.95485, p-value = 7.564e-05\n```\n\n\n:::\n:::\n\n\n\nResults from Shapiro-Wilk test shows significant evidence (p-value \\<0.05) to reject the null hypothesis and conclude that the math scores for both gender do not follow normal distribution . Thus **non parametric: Mann-Whitney *U* test** is used in the following two-sample test model.\n\n::::: panel-tabset\n## Two Sample plot\n\n#### Hypothesis\n\n**H0: Mean math score for male = Mean math score for female**\n\n**H1: Mean math score for male != Mean math score for female**\n\n**alpha = 0.05**\n\n::: {.callout-tip appearance=\"simple\"}\n## Conclusion\n\nSince the p-value is \\> 0.05, we don't have enough evidence to reject the null hypothesis and conclude that there is no statistically significant difference in the mean math scores between males and females.\n:::\n\n::: toggle\n<details>\n\n<summary>**Display Code**</summary>\n\n``` r\nggbetweenstats(\n  data = exam,\n  x = GENDER, \n  y = MATHS,\n  type = \"np\", #nonparametric\n  messages = FALSE)+\n  theme(panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n</details>\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## Argument\n\nggbetweenstats() includes below arguments:\n\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Argument                                         | Description                                                                                                                                                                                                                                                                            |\n+==================================================+========================================================================================================================================================================================================================================================================================+\n| **type**                                         | A character specifying the type of statistical approach and its hypothesis testing:                                                                                                                                                                                                    |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | **No. of groups:**                                                                                                                                                                                                                                                                     |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"parametric\"`: Student's or Welch's *t*-test([stats::t.test()](https://rdrr.io/r/stats/t.test.html))                                                                                                                                                                              |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"nonparametric\"`: Mann-Whitney *U* test([stats::wilcox.test()](https://rdrr.io/r/stats/wilcox.test.html))                                                                                                                                                                         |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"robust\"`: Yuen's test for trimmed means([WRS2::yuen()](https://rdrr.io/pkg/WRS2/man/yuen.html))                                                                                                                                                                                  |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"bayes\"`: Student's *t*-test ([BayesFactor::ttestBF()](https://rdrr.io/pkg/BayesFactor/man/ttestBF.html))                                                                                                                                                                         |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | **No. of groups \\> 2:**                                                                                                                                                                                                                                                                |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   Parametric: Fisher's or Welch's one-way ANOVA ([stats::oneway.test()](https://rdrr.io/r/stats/oneway.test.html))                                                                                                                                                                   |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   Non-parametric: Kruskal-Wallis one-way ANOVA ([stats::kruskal.test()](https://rdrr.io/r/stats/kruskal.test.html))                                                                                                                                                                  |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   Robust: Heteroscedastic one-way ANOVA for trimmed means ([WRS2::t1way()](https://rdrr.io/pkg/WRS2/man/t1way.html))                                                                                                                                                                 |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   Bayes Factor: Fisher's ANOVA ([BayesFactor::anovaBF()](https://rdrr.io/pkg/BayesFactor/man/anovaBF.html))                                                                                                                                                                          |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **pairwise.display\\                              | Decides *which* pairwise comparisons to display. Available options are:                                                                                                                                                                                                                |\n| (ANOVA)**                                        |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"significant\"` (abbreviation accepted: `\"s\"`) \\>\\>\\> only significant                                                                                                                                                                                                             |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"non-significant\"` (abbreviation accepted: `\"ns\"`) \\>\\>\\> only non-significant                                                                                                                                                                                                    |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   `\"all\"`\\>\\>\\> everything                                                                                                                                                                                                                                                           |\n|                                                  |                                                                                                                                                                                                                                                                                        |\n|                                                  | -   If set to `\"none\"`, no pairwise comparisons will be displayed.                                                                                                                                                                                                                     |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **bf.message**                                   | It decides whether to display Bayes Factor in favor of the *null* hypothesis. This argument is relevant only **for parametric test** (Default: `TRUE`).                                                                                                                                |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **var.equal**                                    | whether to treat the two variances as being equal. If `TRUE` then the pooled variance is used to estimate the variance otherwise the Welch (or Satterthwaite) approximation to the degrees of freedom is used.                                                                         |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **centrality.point.args, centrality.label.args** | A list of additional aesthetic arguments to be passed to [`ggplot2::geom_point()`](https://ggplot2.tidyverse.org/reference/geom_point.html) and[`ggrepel::geom_label_repel()`](https://ggrepel.slowkow.com/reference/geom_text_repel.html) geoms, which are involved in mean plotting. |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **point.args**                                   | A list of additional aesthetic arguments to be passed to the [`ggplot2::geom_point()`](https://ggplot2.tidyverse.org/reference/geom_point.html).                                                                                                                                       |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **boxplot.args**                                 | A list of additional aesthetic arguments passed on to [`ggplot2::geom_boxplot()`](https://ggplot2.tidyverse.org/reference/geom_boxplot.html).                                                                                                                                          |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **violin.args**                                  | A list of additional aesthetic arguments to be passed to the [`ggplot2::geom_violin()`](https://ggplot2.tidyverse.org/reference/geom_violin.html).                                                                                                                                     |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **ggsignif.args**                                | A list of additional aesthetic arguments to be passed to [`ggsignif::geom_signif()`](https://const-ae.github.io/ggsignif/reference/stat_signif.html).                                                                                                                                  |\n+--------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n:::::\n\n### 3.3 Oneway ANOVA Test: *ggbetweenstats()* method\n\n[*ggbetweenstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggbetweenstats.html) can also be used to build a visual for One-way ANOVA test on English score by race.\n\nBefore testing, we use Shapiro-Wilk normality test to check if math scores for both genders follow normal distribution:\n\n**Hypothesis**\n\nH0: Math scores for races follow the normal distribution\n\nH1: Math scores for races don't follow the normal distribution\n\nalpha = 0.05\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nby(exam$ENGLISH, exam$RACE, shapiro.test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nexam$RACE: Chinese\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.93491, p-value = 1.305e-07\n\n------------------------------------------------------------ \nexam$RACE: Indian\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.9647, p-value = 0.8483\n\n------------------------------------------------------------ \nexam$RACE: Malay\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.96894, p-value = 0.01251\n\n------------------------------------------------------------ \nexam$RACE: Others\n\n\tShapiro-Wilk normality test\n\ndata:  dd[x, ]\nW = 0.93378, p-value = 0.5182\n```\n\n\n:::\n:::\n\n\n\nResults from Shapiro-Wilk test doesn't show significant evidence (p-value \\>0.05)and fail to reject the null hypothesis. Thus **parametric test** is used in the following onw-way ANOVA model.\n\n#### Hypothesis\n\nH0: There is no difference in English scores among races.\n\nH1: There are differences in English scores among races.\n\nalpha = 0.05\n\n::: {.callout-tip appearance=\"simple\"}\n## Conclusion\n\nSince p-value \\< 0.05, we have enough evidence to reject the null hypothesis and conclude that there are differences in English scores among races.\n\nThe pairwise test `ggbetweenstats()` below further shows that the means of English scores of Chinese, Indian and Malay are significantly different.\n:::\n\n::: toggle\n<details>\n\n<summary>**Display Code**</summary>\n\n``` r\nggbetweenstats(\n  data = exam,\n  x = RACE, \n  y = ENGLISH,\n  type = \"p\", # parametric\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\", # display significant one\n  p.adjust.method = \"fdr\", # False Discovery Rate\n  messages = FALSE\n)+\n  theme(panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n  \n```\n\n</details>\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n### 3.4 Significant Test of Correlation: \\*ggscatterstats()\\*\\*\n\nIn the code chunk below, [*ggscatterstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggscatterstats.html) is used to build a visual for Significant Test of Correlation between Maths scores and English scores.\n\n::: {.callout-note appearance=\"simple\"}\n## Conclusion\n\nThe result indicates a statistically significant posistive relationship (r = 0.83, p-value \\<0.05) between English and math scores. This suggests that higher English scores are correlated with higher math scores.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatterstats(data = exam,\n               x = MATHS,\n               y = ENGLISH,\n               marginal = FALSE,)+\n  theme(panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### 3.5 Significant Test of Association (Depedence): *ggbarstats()* methods\n\nIn the code chunk below, the Maths scores is binned into a 4-class variable by using [*cut()*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cut).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam1 <- exam %>%\n  mutate(MATHS_bins=\n           cut(MATHS, breaks = c(0,60,75,85,100)))\n```\n:::\n\n\n\n-   (0,60\\] means excluding 0 and including 60.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(exam1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  ID         CLASS GENDER RACE    ENGLISH MATHS SCIENCE MATHS_bins\n  <chr>      <fct> <fct>  <fct>     <dbl> <dbl>   <dbl> <fct>     \n1 Student321 3I    Male   Malay        21     9      15 (0,60]    \n2 Student305 3I    Female Malay        24    22      16 (0,60]    \n3 Student289 3H    Male   Chinese      26    16      16 (0,60]    \n4 Student227 3F    Male   Chinese      27    77      31 (75,85]   \n5 Student318 3I    Male   Malay        27    11      25 (0,60]    \n6 Student306 3I    Female Malay        31    16      16 (0,60]    \n```\n\n\n:::\n:::\n\n\n\nIn this code chunk below [*ggbarstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggbarstats.html) is used to build a visual for Significant Test of Association.\n\n**Hypothesis**\n\nH0: There is no association between math_bin and gender.\n\nH1: There is an association between math_bin and gender.\n\nAlpha = 0.05\n\n::: {.callout-tip appearance=\"simple\"}\n## Conclusion\n\nSince the p-value is \\> 0.05, we don't have enough evidence to reject the null hypothesis that there is no association between the math_bin and gender variables.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbarstats(exam1,\n           x = MATHS_bins,\n           y = GENDER)+\n  theme(legend.background = element_rect(fill = \"#f3f1e9\"),\n    panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA\n                                       ))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## 4 Visualizing Models\n\nIn this section, Toyota Corolla case study will be used. We will learn how to visualize model diagnostic and model parameters by using parameters package.\n\n### 4.1 Getting Started\n\n::: panel-tabset\n## Installing and loading the packages\n\nUse the **pacman** package `p_load()` to check, install and launch the following R packages:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(readxl, performance, parameters, see, qqplotr)\n```\n:::\n\n\n\n+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| **Library**   | **Description**                                                                                                                                                              |\n+===============+==============================================================================================================================================================================+\n| performance   | This package provides tools to evaluate and check the performance of regression models                                                                                       |\n+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| parameters    | This package is used to extract and interpret parameters from regression models, e.g., coefficients, standard errors, p-values in an easy-to-interpret format                |\n+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| see & qqplotr | The `see` package is designed for visualizing the results of statistical models and model diagnostics. `qqplotr()`: Plots a QQ plot of the residuals to check for normality. |\n+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n## Importing the data\n\nIn this exercise, ***Exam_data.csv*** will be used. We use `read_csv()` of **readr** to import the data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar_resale <- read_xls(\"data/ToyotaCorolla.xls\",\"data\")\n```\n:::\n\n\n\n## Examining the data\n\nAfter importing the data, let's examine it to understand its data structure:\n\nThe dataset contains 38 attributes and 1,436 observations with no missing values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(car_resale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 38\n     Id Model      Price Age_08_04 Mfg_Month Mfg_Year    KM Quarterly_Tax Weight\n  <dbl> <chr>      <dbl>     <dbl>     <dbl>    <dbl> <dbl>         <dbl>  <dbl>\n1    81 TOYOTA Co… 18950        25         8     2002 20019           100   1180\n2     1 TOYOTA Co… 13500        23        10     2002 46986           210   1165\n3     2 TOYOTA Co… 13750        23        10     2002 72937           210   1165\n4     3  TOYOTA C… 13950        24         9     2002 41711           210   1165\n5     4 TOYOTA Co… 14950        26         7     2002 48000           210   1165\n6     5 TOYOTA Co… 13750        30         3     2002 38500           210   1170\n# ℹ 29 more variables: Guarantee_Period <dbl>, HP_Bin <chr>, CC_bin <chr>,\n#   Doors <dbl>, Gears <dbl>, Cylinders <dbl>, Fuel_Type <chr>, Color <chr>,\n#   Met_Color <dbl>, Automatic <dbl>, Mfr_Guarantee <dbl>,\n#   BOVAG_Guarantee <dbl>, ABS <dbl>, Airbag_1 <dbl>, Airbag_2 <dbl>,\n#   Airco <dbl>, Automatic_airco <dbl>, Boardcomputer <dbl>, CD_Player <dbl>,\n#   Central_Lock <dbl>, Powered_Windows <dbl>, Power_Steering <dbl>,\n#   Radio <dbl>, Mistlamps <dbl>, Sport_Model <dbl>, Backseat_Divider <dbl>, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(car_resale)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [1,436 × 38] (S3: tbl_df/tbl/data.frame)\n $ Id              : num [1:1436] 81 1 2 3 4 5 6 7 8 44 ...\n $ Model           : chr [1:1436] \"TOYOTA Corolla 1.6 5drs 1 4/5-Doors\" \"TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors\" \"TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors\" \" TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors\" ...\n $ Price           : num [1:1436] 18950 13500 13750 13950 14950 ...\n $ Age_08_04       : num [1:1436] 25 23 23 24 26 30 32 27 30 27 ...\n $ Mfg_Month       : num [1:1436] 8 10 10 9 7 3 1 6 3 6 ...\n $ Mfg_Year        : num [1:1436] 2002 2002 2002 2002 2002 ...\n $ KM              : num [1:1436] 20019 46986 72937 41711 48000 ...\n $ Quarterly_Tax   : num [1:1436] 100 210 210 210 210 210 210 210 210 234 ...\n $ Weight          : num [1:1436] 1180 1165 1165 1165 1165 ...\n $ Guarantee_Period: num [1:1436] 3 3 3 3 3 3 3 3 3 3 ...\n $ HP_Bin          : chr [1:1436] \"100-120\" \"< 100\" \"< 100\" \"< 100\" ...\n $ CC_bin          : chr [1:1436] \"1600\" \">1600\" \">1600\" \">1600\" ...\n $ Doors           : num [1:1436] 5 3 3 3 3 3 3 3 3 5 ...\n $ Gears           : num [1:1436] 5 5 5 5 5 5 5 5 5 5 ...\n $ Cylinders       : num [1:1436] 4 4 4 4 4 4 4 4 4 4 ...\n $ Fuel_Type       : chr [1:1436] \"Petrol\" \"Diesel\" \"Diesel\" \"Diesel\" ...\n $ Color           : chr [1:1436] \"Blue\" \"Blue\" \"Silver\" \"Blue\" ...\n $ Met_Color       : num [1:1436] 1 1 1 1 0 0 0 1 1 0 ...\n $ Automatic       : num [1:1436] 1 0 0 0 0 0 0 0 0 0 ...\n $ Mfr_Guarantee   : num [1:1436] 0 0 0 1 1 1 0 0 1 1 ...\n $ BOVAG_Guarantee : num [1:1436] 0 1 1 1 1 1 1 1 1 1 ...\n $ ABS             : num [1:1436] 1 1 1 1 1 1 1 1 1 1 ...\n $ Airbag_1        : num [1:1436] 1 1 1 1 1 1 1 1 1 1 ...\n $ Airbag_2        : num [1:1436] 1 1 1 1 1 1 1 1 1 1 ...\n $ Airco           : num [1:1436] 1 0 1 0 0 1 1 1 1 1 ...\n $ Automatic_airco : num [1:1436] 1 0 0 0 0 0 0 0 0 0 ...\n $ Boardcomputer   : num [1:1436] 0 1 1 1 1 1 1 1 1 1 ...\n $ CD_Player       : num [1:1436] 1 0 1 0 0 0 0 0 1 0 ...\n $ Central_Lock    : num [1:1436] 1 1 1 0 0 1 1 1 1 1 ...\n $ Powered_Windows : num [1:1436] 1 1 0 0 0 1 1 1 1 1 ...\n $ Power_Steering  : num [1:1436] 1 1 1 1 1 1 1 1 1 1 ...\n $ Radio           : num [1:1436] 0 0 0 0 0 0 0 0 0 0 ...\n $ Mistlamps       : num [1:1436] 0 0 0 0 0 1 1 0 0 0 ...\n $ Sport_Model     : num [1:1436] 0 0 0 0 0 0 0 1 0 1 ...\n $ Backseat_Divider: num [1:1436] 0 1 1 1 1 1 1 1 1 1 ...\n $ Metallic_Rim    : num [1:1436] 0 0 0 0 0 0 0 0 0 0 ...\n $ Radio_cassette  : num [1:1436] 0 0 0 0 0 0 0 0 0 0 ...\n $ Tow_Bar         : num [1:1436] 0 0 0 0 0 0 0 0 0 0 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nany(is.na(car_resale))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n:::\n\n### 4.2 Multiple Regression Model using lm()\n\nThe code chunk below is used to calibrate a multiple linear regression model by using *lm()* of Base Stats of R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Price ~ Age_08_04 + Mfg_Year + KM + \n              Weight + Guarantee_Period,\n            data = car_resale)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Price ~ Age_08_04 + Mfg_Year + KM + Weight + Guarantee_Period, \n    data = car_resale)\n\nCoefficients:\n     (Intercept)         Age_08_04          Mfg_Year                KM  \n      -2.637e+06        -1.409e+01         1.315e+03        -2.323e-02  \n          Weight  Guarantee_Period  \n       1.903e+01         2.770e+01  \n```\n\n\n:::\n:::\n\n\n\n### 4.3 Model Diagnostic: checking for multicolinearity:\n\nIn the code chunk, [*check_collinearity()*](https://easystats.github.io/performance/reference/check_collinearity.html) of [**performance**](https://easystats.github.io/performance/index.html) package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_collinearity(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n             Term  VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n               KM 1.46 [ 1.37,  1.57]         1.21      0.68     [0.64, 0.73]\n           Weight 1.41 [ 1.32,  1.51]         1.19      0.71     [0.66, 0.76]\n Guarantee_Period 1.04 [ 1.01,  1.17]         1.02      0.97     [0.86, 0.99]\n\nHigh Correlation\n\n      Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n Age_08_04 31.07 [28.08, 34.38]         5.57      0.03     [0.03, 0.04]\n  Mfg_Year 31.16 [28.16, 34.48]         5.58      0.03     [0.03, 0.04]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\ncheck_c <-check_collinearity(model)\n\nggplot(check_c, aes(x = Term, y = VIF)) +\n  geom_col() +\n  coord_flip() +\n  theme_minimal()+\n    theme(legend.background = element_rect(fill = \"#f3f1e9\"),\n    panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA\n                                       ))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n``` r\ncheck_c <- check_collinearity(model)\nplot(check_c) # showing error\n```\n\n![](images/unnamed-chunk-13-1.png)\n\nThe plots above show high collinearity between Age and Mfg_Year. We should remove one of them.\n\n### 4.4 Model Diagnostic: checking normality assumption\n\nIn the code chunk, [*check_normality()*](https://easystats.github.io/performance/reference/check_normality.html) of [**performance**](https://easystats.github.io/performance/index.html) package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(Price ~ Age_08_04 + KM + \n              Weight + Guarantee_Period, data = car_resale)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_n <- check_normality(model1)\ncheck_n\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Non-normality of residuals detected (p < .001).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_n,type=\"qq\")+\n    theme(legend.background = element_rect(fill = \"#f3f1e9\"),\n    panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA\n                                       ))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\nThe QQ-plot above shows the regression model **does not follow a normal distribution.** The data may have skewness, outliers or heteroscedasticity.\n\n### 4.5 Model Diagnostic: Check model for homogeneity of variances\n\nIn the code chunk, [*check_heteroscedasticity()*](https://easystats.github.io/performance/reference/check_heteroscedasticity.html) of [**performance**](https://easystats.github.io/performance/index.html) package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_h <- check_heteroscedasticity(model1)\ncheck_h\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(check_h)+\n    theme(legend.background = element_rect(fill = \"#f3f1e9\"),\n    panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA\n                                       ))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\nThe plot and the check_heteroscedasticity(model1) result show the model having heteroscedasticity issue. It is possible the model is misspecified, such as not capturing the true relationship between the dependent and independent variables.\n\n### 4.6 Model Diagnostic: Complete check\n\nWe can also perform the complete by using [*check_model()*](https://easystats.github.io/performance/reference/check_model.html).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(model1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\n### 4.7 Visualising Regression Parameters: see methods\n\nIn the code below, `plot()` of **see** package and `parameters()` of **parameters** package are used to visualise the parameters of a regression model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(parameters(model1))+\n    theme(legend.background = element_rect(fill = \"#f3f1e9\"),\n    panel.background = element_rect(fill = \"#f3f1e9\"),\n        plot.background = element_rect(fill = \"#f3f1e9\",color = NA\n                                       ))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n### 4.8 Visualising Regression Parameters: *ggcoefstats()* methods\n\nIn the code below, [*ggcoefstats()*](https://indrajeetpatil.github.io/ggstatsplot/reference/ggcoefstats.html) of ggstatsplot package to visualise the parameters of a regression model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcoefstats(model1, output = \"plot\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex04_b_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n## 5 Reference\n\n-   Kam, T.S. (2025). [Visual Statistical Analysis](https://r4va.netlify.app/chap10).\n",
    "supporting": [
      "Hands-on_Ex04_b_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}