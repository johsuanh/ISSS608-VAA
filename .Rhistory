scales = "free_x") +
labs(
title = "Sailing Towards Profit: Which Ship Types Lead the Way?",
subtitle = "The Medium Fish Carrier reigns as the top performer, with a revenue of 595K and a profit margin of 36.6%. \nIn contrast, the Medium Bulk Carrier underperforms, generating 516K in revenue and the lowest margin at 7.4%",
caption = "*Mean Margin = 21.3%\n*Mean Revenue = 523K\n*Mean Cost per nm = 2.31",
x = "Ship Type",
y = "",
fill = "Metric"
) +
theme_classic() +
scale_fill_manual(values = my_palette) +
scale_linetype_manual(name = "Reference",
values = c("Mean*" = "dashed","Median"="dashed")) +
guides(
fill = guide_legend(order = 1),
linetype = guide_legend(order = 2) #adding line type legend
) +
theme(
axis.text.y = element_text(size = 6,color="grey20"),
axis.text.x = element_text(size = 6,color="grey20"),
axis.title.x = element_text(size = 8,color="grey20"),
axis.title.y = element_text(size = 8,color="grey20"),
strip.text = element_text(size = 7, face = "bold"),
legend.position = "top",
legend.title = element_text(size = 6),
legend.key.size = unit(0.2, "cm"),
legend.text = element_text(size = 6),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9", color = NA),
plot.title = element_text(size = 11,hjust = 0.5,face='bold'),
plot.subtitle = element_text(size = 6, hjust = 0, lineheight = 1.1),
plot.caption = element_text(size = 6,color="grey40"),
plot.margin = margin(10, 50, 10 ,30),
panel.spacing = unit(1, "lines"),
strip.placement = "outside",
strip.switch.pad.wrap = unit(2, "cm")
)
tooltip_css <- "background-color:white; font-style: bold; font-size:10px; color:black; border-radius: 5px; margin: 3px; padding:3px;"
# Convert to Interactive
girafe(
code = print(p),
width_svg = 6,
height_svg = 4,
options = list(
opts_hover(css = "stroke-width:3px; opacity: 1;"),
opts_hover_inv(css = "opacity: 0.2;"),
opts_tooltip(css = tooltip_css)
))
#| echo: false
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 7),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 6),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 7),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8,
label.size = 3,
colors = c("#468C6C99", "white", "#D989AE99") ),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8,
label.size = 3,
colors = c("#468C6C99", "white", "#D989AE99")),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8,
label.size = 3,
colors = c("#468C6C", "white", "#D989AE")),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c("#468C6C", "white", "#D989AE"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8,
label.size = 3,
),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c("#468C6C", "white", "#D989AE"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8,
label.size = 3
),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c("#468C6C", "white", "#D989AE"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#468C6C"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
cor.vars = 1:11,
colors = c(  "#D989AE","white","#468C6C"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
cor.vars = 1:10,
colors = c(  "#D989AE","white","#468C6C"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
cor.vars = 1:15,
colors = c(  "#D989AE","white","#468C6C"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#468C6C"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE99","white","#F2CD8899"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#F2CD88"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#F2CD88ß"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt") )
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#F2CD88ß"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt"))
#| echo: false
#| fig-height: 6
#| fig-width: 12
#| out-extra: "style='max-width:100%; display: block;'"
#| out-width: 100%
ship_cleaned_num <- ship_cleaned %>% select_if(is.numeric)
ggcorrmat(
data = ship_cleaned_num,
colors = c(  "#D989AE","white","#F2CD88"),
ggcorrplot.args = list(outline.color = "black",
hc.order = TRUE,
tl.cex = 8),
title    = "Correlogram for ship dataset",
subtitle = "None of pairs is significant at p < 0.05")+
theme(plot.title = element_text(size=13, hjust=0),
legend.background = element_rect(fill = "#f3f1e9"),
panel.background = element_rect(fill = "#f3f1e9"),
plot.background = element_rect(fill = "#f3f1e9",color = NA),
axis.text.x = element_text(angle=30, hjust=1, size= 7),
axis.text.y = element_text(size=7),
panel.grid = element_blank(),
plot.margin = margin(t = 15, r = 50, b = 15, l = 50, unit = "pt"))
